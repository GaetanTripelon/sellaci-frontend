<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <script src="config.js"></script>
    <title>Reset Password</title>
    <link rel="stylesheet" href="reset_password.css">
    <link href='https://fonts.googleapis.com/css?family=Barlow+Condensed' rel='stylesheet'>
</head>

<body>
    <p id="register">Mettre à jour mon mot de passe ? On t'envoie un email gros malin, regarde tes spams</p>
    <p id="reset_password_email">Email:</p><input type='text' name='email' id="reset_password_email_box"><br>
    <input type="submit" value="Je réinitialise mon mot de passe" id="reset_password_generation", onclick="reset_password()">
    <div>
        <label id="log" onclick="backToLogin()">RETOURNER SUR LA PAGE LOGIN</label>
    </div>
</body>

<script>
    function reset_password(){
        data = {'email': document.getElementById('reset_password_email_box').value}
        console.log(data)

        postData(URL_API + "reset_password", data)
            .then((login_success) => {
                if(login_success['success']){
                    console.log('RESET PASSWORD SUCCESS')
                    window.location = "index.html";
                }else{
                    console.log('RESET PASSWORD FAIL')
                }
            }
        );
    }

    // Example POST method implementation:
    async function postData(url = '', data = {}) {
        const response = await fetch(url, {
            method: 'POST', 
            mode: 'cors', 
            cache: 'no-cache', 
            credentials: 'same-origin', 
            headers: {
            'Content-Type': 'application/json'
            },
            redirect: 'follow', 
            referrerPolicy: 'no-referrer',
            body: JSON.stringify(data) 
        });
        return response.json();
    }
    function backToLogin(){
        window.location = "login.html";
    }
</script>

</html>
