<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <script src="config.js"></script>
    <title>Login</title>
    <link rel="stylesheet" href="login.css">
    <link href='https://fonts.googleapis.com/css?family=Barlow+Condensed' rel='stylesheet'>
</head>

<body>
    <p id="register">S'enregistrer</p>
    <p id="email">Email:</p><input type='text' name='email' id="email_box"><br>
    <p id="password">Password:</p><input type='password' name='password' id="password_box"><br>
    <input type="submit" value="Je me connecte" id='trial' onclick="login()"/>
    <form action="signup.html" id="signup_action">
        <input type="submit" value="Je me créé un compte" id="create">
    </form>
    <form action="reset_password.html" id="reset_password">
        <input type="submit" value="Réinitialiser mon mot de passe" id="reset_password_action">
    </form>
</body>

<script>

    function login(){
        data = {
            "email": document.getElementById("email_box").value,
            "password": document.getElementById("password_box").value,
        }

        console.log(data)

        postData(URL_API + "login", data)
            .then((login_success) => {
                if(login_success['success']){
                    console.log('LOGIN SUCCESS')
                    window.location = "menu.html";
                }else{
                    console.log('LOGIN FAIL')
                }
            }
        );
    }

    // Example POST method implementation:
    async function postData(url = '', data = {}) {
        const response = await fetch(url, {
            method: 'POST', 
            mode: 'cors', 
            cache: 'no-cache', 
            credentials: 'same-origin', 
            headers: {
            'Content-Type': 'application/json'
            },
            redirect: 'follow', 
            referrerPolicy: 'no-referrer',
            body: JSON.stringify(data) 
        });
        return response.json();
    }
    
</script>

</html>
